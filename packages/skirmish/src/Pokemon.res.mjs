// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Pos$Kaplay from "@nojaf/rescript-kaplay/src/Components/Pos.res.mjs";
import * as Area$Kaplay from "@nojaf/rescript-kaplay/src/Components/Area.res.mjs";
import * as Anchor$Kaplay from "@nojaf/rescript-kaplay/src/Components/Anchor.res.mjs";
import * as Health$Kaplay from "@nojaf/rescript-kaplay/src/Components/Health.res.mjs";
import * as Shader$Kaplay from "@nojaf/rescript-kaplay/src/Components/Shader.res.mjs";
import * as Sprite$Kaplay from "@nojaf/rescript-kaplay/src/Components/Sprite.res.mjs";
import * as GameObjRaw$Kaplay from "@nojaf/rescript-kaplay/src/Components/GameObjRaw.res.mjs";
import * as GameContext$Skirmish from "./GameContext.res.mjs";
import * as Thundershock$Skirmish from "./Thundershock.res.mjs";
import GlowFragraw from "../shaders/glow.frag?raw";
import DarkenFragraw from "../shaders/darken.frag?raw";
import Outline2pxFragraw from "../shaders/outline2px.frag?raw";

GameObjRaw$Kaplay.Comp({});

Pos$Kaplay.Comp({});

Sprite$Kaplay.Comp({});

Area$Kaplay.Comp({});

Health$Kaplay.Comp({});

Anchor$Kaplay.Comp({});

Shader$Kaplay.Comp({});

let tag = "pokemon";

function frontSpriteName(id) {
  return "pokemon-" + id.toString() + "-front";
}

function backSpriteName(id) {
  return "pokemon-" + id.toString() + "-back";
}

function frontSpriteUrl(id) {
  return `/sprites/` + id.toString() + `-front.png`;
}

function backSpriteUrl(id) {
  return `/sprites/` + id.toString() + `-back.png`;
}

let glowSource = GlowFragraw;

let outline2pxSource = Outline2pxFragraw;

let darkenSource = DarkenFragraw;

function load(id) {
  GameContext$Skirmish.k.loadSprite(frontSpriteName(id), frontSpriteUrl(id), {
    singular: true
  });
  GameContext$Skirmish.k.loadSprite(backSpriteName(id), backSpriteUrl(id), {
    singular: true
  });
  GameContext$Skirmish.k.loadShader("glow", undefined, glowSource);
  GameContext$Skirmish.k.loadShader("outline2px", undefined, outline2pxSource);
  GameContext$Skirmish.k.loadShader("darken", undefined, darkenSource);
}

function make(id) {
  let gameObj = GameContext$Skirmish.k.add([
    GameContext$Skirmish.k.pos(GameContext$Skirmish.k.center().x, GameContext$Skirmish.k.height() * 0.8),
    GameContext$Skirmish.k.sprite(backSpriteName(id)),
    GameContext$Skirmish.k.area(),
    GameContext$Skirmish.k.health(20),
    GameContext$Skirmish.k.anchor("center"),
    tag
  ]);
  let widthPx = gameObj.width;
  let heightPx = gameObj.height;
  gameObj.use(GameContext$Skirmish.k.shader("glow", () => ({
    u_time: GameContext$Skirmish.k.time(),
    u_resolution: GameContext$Skirmish.k.vec2(widthPx, heightPx),
    u_thickness: 0.7,
    u_color: GameContext$Skirmish.k.Color.fromHex("#fef9c2"),
    u_intensity: 0.66,
    u_pulse_speed: 5.0
  })));
  GameContext$Skirmish.k.onUpdate(() => {
    let leftDown = GameContext$Skirmish.k.isKeyDown("left") || GameContext$Skirmish.k.isKeyDown("a");
    let rightDown = GameContext$Skirmish.k.isKeyDown("right") || GameContext$Skirmish.k.isKeyDown("d");
    let upDown = GameContext$Skirmish.k.isKeyDown("up") || GameContext$Skirmish.k.isKeyDown("w");
    let downDown = GameContext$Skirmish.k.isKeyDown("down") || GameContext$Skirmish.k.isKeyDown("s");
    let speed = GameContext$Skirmish.k.vec2(200, 200);
    if (upDown && !downDown) {
      gameObj.move(GameContext$Skirmish.k.Vec2.UP.scale(speed));
      gameObj.sprite = backSpriteName(id);
      return;
    } else if (downDown && !upDown) {
      gameObj.move(GameContext$Skirmish.k.Vec2.DOWN.scale(speed));
      gameObj.sprite = frontSpriteName(id);
      return;
    } else if (leftDown && !rightDown) {
      gameObj.move(GameContext$Skirmish.k.Vec2.LEFT.scale(speed));
      return;
    } else if (rightDown && !leftDown) {
      gameObj.move(GameContext$Skirmish.k.Vec2.RIGHT.scale(speed));
      return;
    } else {
      return;
    }
  });
  GameContext$Skirmish.k.onKeyRelease(key => {
    if (key === "space") {
      return Thundershock$Skirmish.make(extra => gameObj.add(extra), gameObj.pos, GameContext$Skirmish.k.Vec2.UP);
    }
  });
  return gameObj;
}

let movementSpeed = 200;

export {
  tag,
  frontSpriteName,
  backSpriteName,
  frontSpriteUrl,
  backSpriteUrl,
  glowSource,
  outline2pxSource,
  darkenSource,
  load,
  movementSpeed,
  make,
}
/*  Not a pure module */
